#cover
  .g-wide-5-24.g-1-6
    != partial('_shared/haiiro_icon', { size: '30', color: '#e0559f' })
  .g-wide-19-24.g-10-12
  .g-wide-5-24.g-1-24
  .g-wide-14-24.g-11-12
    .myself
      .name= public._data.meta.copyright
      .occupation= public._data.meta.occupation

#switcher
  a#planning-tab(href='#planning') Planning
  a#design-tab(href='#design') Design

#works
  - each tag in ['planning', 'design']
    - var filtered = public._data.works.filter(function (w) { return (w.tags.indexOf(tag) != -1); } );
    - eval(tag + '_works = filtered');

  .g-wide-6-24.g-1-24
  .g-wide-12-24.g-11-12
    #planning-works.filtered-works
      each work in planning_works
        a(href= '/works/' + work.name, data-colors= work.colors.join(','))
          .work
            .g-wide-3-4.g-1-1.title
              = work.title
            .g-wide-1-4.g-1-1.year
              = work.published_year
  .g-wide-5-24.g-1-24

  .g-wide-2-24.g-1-24
  .g-wide-20-24.g-11-12
    #design-works.filtered-works
      each work in design_works
        .g-wide-1-3.g-1-1
          .work-image
            a(href= '/works/' + work.name, data-colors= work.colors.join(','))
              img(src= '/images/' + work.name + '_1.jpg')

!= partial('_shared/footer')

script.
  (function() {
    var plannings = u('#planning-tab, #planning-works');
    var designs = u('#design-tab, #design-works');
    var switchWorks = function(target) {
      (target == 'planning' ? plannings : designs).addClass('active');
      (target == 'planning' ? designs : plannings).removeClass('active');
    };
    u('#planning-tab, #design-tab').on('click', function(e) { switchWorks(u(this).attr('id').replace('-tab', '')); });
    switchWorks(window.location.hash == '#design' ? 'design' : 'planning');

    var rects = u('svg.haiiro-icon > rect');
    u('#works a').on('mouseover', function(e) {
      var colors = u(this).data('colors').split(',');
      var pallet = [];
      for (i = 0; i < rects.length; i++) {
        pallet.push(colors.length > i ? colors[i] : (colors[i - colors.length] ? colors[i - colors.length] : colors[1]));
      }
      paintHaiiro(pallet);
    });
    var paintHaiiro = function(colors) {
      if (colors.length != 7) return;
      for (i = 0; i < rects.length; i++) { u(rects.nodes[i]).attr('fill', colors[i]); }
    }
    var defaultColors = ['#d4d4d4', '#a7a7a7', '#cfcfcf', '#d7d7d7', '#cdcdcd', '#c7c7c7', '#d1d1d1'];
    u('#works a').on('mouseleave', function(e) {
      paintHaiiro(defaultColors);
    });
    paintHaiiro(defaultColors);
  })();
